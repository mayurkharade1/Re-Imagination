import java.sql.Driver;
import java.time.Duration;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.Set;
import java.util.concurrent.ThreadPoolExecutor;
import java.util.concurrent.TimeUnit;
import javax.swing.JOptionPane;
import org.checkerframework.checker.units.qual.Time;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.WindowType;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import io.opentelemetry.exporter.logging.SystemOutLogRecordExporter;

public class Login {
	
	//WebDriver wd = new ChromeDriver();
	//WebDriverWait w = new WebDriverWait(wd,Duration.ofSeconds(10));

	
	 public WebDriver wd;
	  public Login(){
		  ChromeOptions options = new ChromeOptions();
			options.setAcceptInsecureCerts(true);
	   wd = new ChromeDriver(options);
	  }
	  public WebDriver getdriver(){
	    if (wd == null){
	    	ChromeOptions options = new ChromeOptions();
			options.setAcceptInsecureCerts(true);
	      wd = new ChromeDriver(options);
	      return wd;
	    }else{
	      return wd;
	    }
	  }
	
	  
	  public void login1() throws InterruptedException {
		//WebDriver wd=new ChromeDriver();
		wd.manage().window().maximize();
		
		wd.get("https://kioskuat.bank.sbi/unifyapp/login/");
		
		WebElement username=wd.findElement(By.cssSelector("input[placeholder='Enter User ID']"));
		
		username.sendKeys("3K580036");
		
		WebElement password= wd.findElement(By.cssSelector("input[placeholder='Enter Password']"));
		
		password.sendKeys("dfi@1234");
		
		String captcha;
		captcha = JOptionPane.showInputDialog("Please Enter The Captcha");
		WebElement Captcha = wd.findElement(By.cssSelector("[alt=\"CaptchaImage\"]"));
		Captcha.sendKeys(captcha);
		
		wd.findElement(By.xpath("//div[@class='col-9']")).click();
		
		Thread.sleep(9000);
		
		WebElement fp = wd.findElement(By.xpath("//img[@alt='FingerprintFirstNew']"));
		
		fp.click();
		Thread.sleep(5000);
				
		

	}
	
	public void do_Login() throws InterruptedException {
	

		ChromeOptions options = new ChromeOptions();
		options.setAcceptInsecureCerts(true);

		//WebDriver wd = new ChromeDriver(options);
		wd.get("https://192.12.109.127/");
		WebDriverWait w = new WebDriverWait(wd,Duration.ofSeconds(10));

		Thread.sleep(3000); 
		String parent = wd.getWindowHandle();
		Set<String> s = wd.getWindowHandles();

		// Now iterate using Iterator

		Iterator<String> I1 = s.iterator();
		while (I1.hasNext()) {

			String child_window = I1.next();
			
			if (!parent.equals(child_window))

			{
				wd.switchTo().window(child_window);
				System.out.println(wd.switchTo().window(child_window).getTitle());

			}
		}
		
		//wd.switchTo().alert().accept(); //Peri se

		wd.findElement(By.xpath("//*[@id='usernamefield21']/input")).sendKeys("3K580037");
		wd.findElement(By.xpath("//*[@id='passwfield21']/input")).sendKeys("Asd@1234");
		String captcha;

		captcha = JOptionPane.showInputDialog("Please Enter The Captcha");
		WebElement Captcha = wd.findElement(By.name("txtInput"));
		Captcha.sendKeys(captcha);

		//Thread.sleep(5000);
		wd.findElement(By.xpath("//*[@id=\"btn3\"]/input")).click();
		System.out.println(captcha);

		wd.manage().window().maximize();
		// Thread.sleep(5000);
		Thread.sleep(2000);
		
		//click on redirection link 
		wd.switchTo().frame("mainframe");    
		
		wd.findElement(By.xpath("/html/body/form[1]/input")).click();
		
		Thread.sleep(1000);
		wd.findElement(By.xpath("/html[1]/body[1]/form[2]/div[1]/div[2]/div[2]/div[2]/a[1]/b[1]")).click();
		System.out.println("Clicked on Redirection link");
		
		Thread.sleep(2000);
		wd.switchTo().alert().accept();

		//w.until(ExpectedConditions.alertIsPresent()).accept();
		//w.until(ExpectedConditions.alertIsPresent()).accept();
		
		//Thread.sleep(2000);		
		//w.until(ExpectedConditions.alertIsPresent()).accept();
		//w.until(ExpectedConditions.alertIsPresent()).accept();
		//wd.switchTo().alert().accept();

	
		Thread.sleep(2000);     
		wd.switchTo().window(parent);  
		wd.manage().window().maximize();

		Set<String> tabs = wd.getWindowHandles();
		/*Iterator<String> Iterator = tabs.iterator();
		while (Iterator.hasNext()) {
			
		wd.switchTo().window(Iterator.next());
		Thread.sleep(5000);		
		}*/
		
		List <String> frame= new ArrayList(tabs);
		
		//String old=frame.get(0);
		//String new1=frame.get(1);
		//wd.switchTo().window(new1);
		
		for (String tab:frame)
		{
			String title = wd.switchTo().window(tab).getTitle();
			
			if (title.equals("KioskApp")) 
			{
				wd.manage().window().maximize();
			}
			
		}
		
		
		
		
		//wd.switchTo().alert().accept();
		//wd.switchTo().alert().accept();
		//Thread.sleep(5000);
		
		//w.until(ExpectedConditions.alertIsPresent()).accept();
		
		//Thread.sleep(2000);	
		
		//wd.switchTo().alert().accept();
		System.out.println("Tab switched to:" + wd.getTitle());
		wd.manage().window().maximize();
		Thread.sleep(2000);		

	}

}